<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Analysis</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #f8f9fa; }
        .card { margin-bottom: 1rem; }
        .insight-list li { margin-bottom: .6rem; }
        .lead-label { font-weight: 600; display: inline-block; width: 190px; }
        .insight-row { margin-bottom: 0.4rem; }
        img.rounded { box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
    </style>
</head>
<body>
<div class="container py-4">
    <h1 class="mb-3">Automated Data Analysis - {{ filename }}</h1>
    <a href="/dashboard" class="btn btn-secondary mb-3">Back to Dashboard</a>

    <div class="row">
        <div class="col-lg-7">
            <div class="card p-3 mb-3">
    <h5 class="mb-2">Executive Insights</h5>
    {% if insights %}
        <ul class="list-group list-group-flush">
            {% for item in insights %}
                <li class="list-group-item">
                    <strong>Insight {{ loop.index }}:</strong>
                    <span>{{ item }}</span>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No insights available.</p>
    {% endif %}
</div>


            <div class="card p-3">
                <h5 class="mb-3">Actionable Recommendations</h5>
                <ul>
                    {% if recommendations %}
                        {% for r in recommendations %}
                            <li>{{ r }}</li>
                        {% endfor %}
                    {% else %}
                        <li>No immediate recommendations. Data appears healthy.</li>
                    {% endif %}
                </ul>
            </div>

            <div class="card p-3">
                <h5 class="mb-2">Statistical Summary</h5>
                <div class="table-responsive">
                    {{ stats|safe }}
                </div>
            </div>

            <div class="card p-3">
                <h5 class="mb-2">Missing Values (per column)</h5>
                <div class="table-responsive">
                    {{ null_counts|safe }}
                </div>
            </div>

            <div class="card p-3">
                <h5 class="mb-2">Unique Value Counts</h5>
                <div class="table-responsive">
                    {{ unique_counts|safe }}
                </div>
            </div>
        </div>

        <div class="col-lg-5">
            <div class="card p-3 mb-3">
                <h6 class="mb-2">Visualizations</h6>

                {% if plots['heatmap'] %}
                    <div class="mb-3">
                        <h6 class="small">Correlation Heatmap</h6>
                        <img src="{{ url_for('static', filename=plots['heatmap']) }}" class="img-fluid rounded" alt="heatmap">
                    </div>
                {% endif %}

                {% if plots['trends'] %}
                    <div class="mb-3">
                        <h6 class="small">Trends</h6>
                        <img src="{{ url_for('static', filename=plots['trends']) }}" class="img-fluid rounded" alt="trends">
                    </div>
                {% endif %}

                {% if plots['outliers_box'] %}
                    <div class="mb-3">
                        <h6 class="small">Outlier Boxplots</h6>
                        <img src="{{ url_for('static', filename=plots['outliers_box']) }}" class="img-fluid rounded" alt="outliers">
                    </div>
                {% endif %}

                {% if plots['feature_importance'] %}
                    <div class="mb-3">
                        <h6 class="small">Feature Importance</h6>
                        <img src="{{ url_for('static', filename=plots['feature_importance']) }}" class="img-fluid rounded" alt="importance">
                    </div>
                {% endif %}

                {% if plots['quality_score'] %}
                    <div class="mb-3">
                        <h6 class="small">Data Quality Score</h6>
                        <img src="{{ url_for('static', filename=plots['quality_score']) }}" class="img-fluid rounded" alt="quality">
                    </div>
                {% endif %}

                {% if plots['skewness'] %}
                    <div class="mb-3">
                        <h6 class="small">Skewness</h6>
                        <img src="{{ url_for('static', filename=plots['skewness']) }}" class="img-fluid rounded" alt="skewness">
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
</body>
</html>
